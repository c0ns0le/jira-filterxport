var onSaveClicked=function(e,o){var t=e.selectionText,i=CryptoJS.SHA256(t).toString();window.console.log("onSaveClicked: check for hash"+i),chrome.storage.sync.get("jiraFilters",function(e){if(0!==Object.keys(e).length){e=e.jiraFilters,window.console.log(e);for(var n in e)if(n===i)return window.console.log("filter already exist, firing exist message"),void chrome.tabs.sendMessage(o.id,{filterAlreadyExists:e[n].name})}var s={id:i.toString(),name:"",filter:t};window.console.log("requesting new filter name send ping..."),chrome.tabs.sendMessage(o.id,{addFilter:s},function(e){window.console.log("message send, got... "+e.status)})})};chrome.contextMenus.create({title:chrome.i18n.getMessage("SaveFilter"),contexts:["editable"],onclick:onSaveClicked}),chrome.runtime.onMessage.addListener(function(e,o,t){switch(e.type){case"mail-share":window.console.log("got mail-share request, opening tab");var i=JSON.parse(atob(e.data)),n="mailto:foor@bar.com?subject=Checkout my cool Jira filter: "+i.name;chrome.tabs.create({url:n},function(e){window.console.log(e),window.setTimeout(function(){chrome.tabs.remove(e.id)},500)});break;case"delete-filter":window.console.log("got delete request."),chrome.storage.sync.get("jiraFilters",function(o){o=o.jiraFilters,delete o[e.data.id],chrome.storage.sync.set({jiraFilters:o},function(){window.console.log("filter deleted")})}),t({status:{deleted:!0}})}});