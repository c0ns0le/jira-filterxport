var onSaveClicked=function(e,t){var o=e.selectionText,i=CryptoJS.SHA256(o).toString();window.console.log("onSaveClicked: check for hash"+i),chrome.storage.sync.get("jiraFilters",function(e){if(0!==Object.keys(e).length){e=e.jiraFilters,window.console.log(e);for(var n in e)if(n===i)return window.console.log("filter already exist, firing exist message"),void chrome.tabs.sendMessage(t.id,{filterAlreadyExists:e[n].name})}var s={id:i.toString(),name:"",filter:o};window.console.log("requesting new filter name send ping..."),chrome.tabs.sendMessage(t.id,{addFilter:s},function(e){window.console.log("message send, got... "+e.status)})})};chrome.contextMenus.create({title:chrome.i18n.getMessage("SaveFilter"),contexts:["editable"],onclick:onSaveClicked}),chrome.runtime.onMessage.addListener(function(e,t,o){switch(e.type){case"mail-share":window.console.log("got mail-share request, opening tab");var i=JSON.parse(atob(e.data)),n="mailto:?body="+chrome.i18n.getMessage("ShareMailPublish",i.filter)+"&subject="+chrome.i18n.getMessage("CheckoutFilter")+": "+i.name;chrome.tabs.create({url:n},function(e){window.console.log(e),window.setTimeout(function(){chrome.tabs.remove(e.id)},500)});break;case"delete-filter":window.console.log("got delete request."),chrome.storage.sync.get("jiraFilters",function(t){t=t.jiraFilters,delete t[e.data.id],chrome.storage.sync.set({jiraFilters:t},function(){window.console.log("filter deleted")})}),o({status:{deleted:!0}})}});