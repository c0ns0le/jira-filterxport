var JiraFilterXport=function(){var e=function(){this.overlay=null};e.prototype={generateOverlay:function(){this.overlay=document.createElement("div"),this.overlay.setAttribute("class","jira-filter-xport-overlay"),this.overlay.setAttribute("id","jira-filter-xport-overlay"),document.body.appendChild(this.overlay)},generateAddNewFilter:function(e){var t=document.querySelector("section#content header.saved-search-selector h1.search-title");if(!t)return void window.console.log("it seems that, we art not in filter area. Cancel request");var r=t.innerHTML;this.generateOverlay();var i=document.createElement("div");i.setAttribute("id","jira-filter-xport-overlay-form"),i.innerHTML='<div class="inner-form"><h5>'+chrome.i18n.getMessage("SaveNewFilter")+'</h5><input type="text" id="jira-filter-xport-new-filter-name" class="filter-input" value="'+r+'"><input type="hidden" id="jira-filter-xport-new-filter-data" class="filter-input" value="'+e+'"><button id="jira-filter-xport-new-filter-name-save" class="jira-filter-xport-btn save">'+chrome.i18n.getMessage("Save")+'</button><button id="jira-filter-xport-new-filter-name-cancel" class="jira-filter-xport-btn cancel">'+chrome.i18n.getMessage("Cancel")+"</button></div>",document.body.appendChild(i),document.getElementById("jira-filter-xport-new-filter-name-cancel").addEventListener("click",function(){window.console.log("cancel clicked, remove overlay"),document.body.removeChild(document.getElementById("jira-filter-xport-overlay")),document.body.removeChild(document.getElementById("jira-filter-xport-overlay-form"))},!1),document.getElementById("jira-filter-xport-new-filter-name-save").addEventListener("click",function(){window.console.log("save clicked, save the filter");var e=document.getElementById("jira-filter-xport-new-filter-data").value,t=document.getElementById("jira-filter-xport-new-filter-name").value;e&&t&&chrome.storage.sync.get("jiraFilters",function(r){r=0!==Object.keys(r).length?r.jiraFilters:{};var i=JSON.parse(atob(e));i.name=t,r[i.id]=i,window.console.log(r),chrome.storage.sync.set({jiraFilters:r},function(){window.console.log("new filter saved")})}),document.body.removeChild(document.getElementById("jira-filter-xport-overlay")),document.body.removeChild(document.getElementById("jira-filter-xport-overlay-form"))},!1)},generateFilterExists:function(e){this.generateOverlay();var t=document.createElement("div");t.setAttribute("id","jira-filter-xport-overlay-form"),t.innerHTML='<div class="inner-form"><span>'+chrome.i18n.getMessage("FilterAlreadyExists")+"</span><br/><span>"+chrome.i18n.getMessage("LookAtFilter"," <strong>"+e+"</strong>")+'</span><br/><button id="jira-filter-xport-new-filter-name-close" class="jira-filter-xport-btn close">'+chrome.i18n.getMessage("Close")+"</button></div>",document.body.appendChild(t),document.getElementById("jira-filter-xport-new-filter-name-close").addEventListener("click",function(){window.console.log("close clicked, remove overlay"),document.body.removeChild(document.getElementById("jira-filter-xport-overlay")),document.body.removeChild(document.getElementById("jira-filter-xport-overlay-form"))},!1)}},chrome.runtime.onMessage.addListener(function(t,r,i){i({status:"pong"});var o=new e;t.addFilter?(window.console.log("got new filter request, init window"),window.console.log(t.addFilter),o.generateAddNewFilter(btoa(JSON.stringify(t.addFilter)))):t.filterAlreadyExists&&(window.console.log("got filter exists request, init window"),window.console.log(t.filterAlreadyExists),o.generateFilterExists(t.filterAlreadyExists))})}();document.addEventListener("DOMContentLoaded",JiraFilterXport,!1);